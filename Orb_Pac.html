<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AI Maze: Solo vs Versus</title>
    <style>
      body {
        margin: 0;
        background: #000;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        font-family: "Courier New", monospace;
        color: white;
      }
      canvas {
        border: 4px solid #1919a6;
        display: none;
      }
      #menu {
        text-align: center;
        background: #111;
        padding: 40px;
        border: 2px solid #00ffcc;
        box-shadow: 0 0 20px #00ffcc;
      }
      #ui {
        margin-bottom: 10px;
        text-align: center;
        display: none;
      }
      button {
        background: #00ffcc;
        color: #000;
        border: none;
        padding: 15px 30px;
        margin: 10px;
        cursor: pointer;
        font-weight: bold;
        font-family: "Courier New";
      }
      button:hover {
        background: #fff;
        box-shadow: 0 0 15px #00ffcc;
      }
      .power {
        color: #00ff00;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div id="menu">
      <h1>MAZE ESCAPE 2026</h1>
      <p>Choose your experience:</p>
      <button onclick="startGame('solo')">SOLO (VS AI)</button>
      <button onclick="startGame('versus')">VERSUS (2 PLAYER)</button>
      <p style="font-size: 0.8em; color: #888">Arrows: P1 | WASD: P2</p>
    </div>

    <div id="ui">
      <h2 id="mode-text">MODE: SOLO</h2>
      <div>
        SCORE: <span id="score">0</span> |
        <span id="power-timer" class="power"></span>
      </div>
    </div>
    <canvas id="gameCanvas"></canvas>

    <script>
      const canvas = document.getElementById("gameCanvas");
      const ctx = canvas.getContext("2d");
      const scoreEl = document.getElementById("score");
      const powerEl = document.getElementById("power-timer");

      const TILE_SIZE = 40;
      const GRID_W = 15,
        GRID_H = 15;
      canvas.width = TILE_SIZE * GRID_W;
      canvas.height = TILE_SIZE * GRID_H;

      let score = 0,
        gameMode = "solo",
        powerUpActive = false,
        isGameOver = false;
      let p1 = { x: 1, y: 1 };
      let hunter = { x: 13, y: 13 };

      const map = [
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
        [1, 0, 2, 0, 1, 0, 0, 0, 0, 0, 1, 0, 2, 0, 1],
        [1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1],
        [1, 3, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 3, 1],
        [1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1],
        [1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1],
        [1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 1],
        [1, 2, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 2, 1],
        [1, 0, 1, 1, 1, 0, 0, 2, 0, 0, 1, 1, 1, 0, 1],
        [1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1],
        [1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1],
        [1, 3, 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 3, 1],
        [1, 0, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1],
        [1, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 0, 1],
        [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
      ];

      function startGame(mode) {
        gameMode = mode;
        document.getElementById("menu").style.display = "none";
        document.getElementById("ui").style.display = "block";
        canvas.style.display = "block";
        document.getElementById("mode-text").innerText =
          mode === "solo" ? "MODE: SOLO (AI)" : "MODE: VERSUS";
        draw();
      }

      // --- AI LOGIC (BFS) ---
      function getNextAIMove() {
        let queue = [[hunter.x, hunter.y, []]];
        let visited = new Set();
        visited.add(`${hunter.x},${hunter.y}`);

        while (queue.length > 0) {
          let [cx, cy, path] = queue.shift();
          if (cx === p1.x && cy === p1.y) return path[0];
          for (let [dx, dy] of [
            [0, 1],
            [0, -1],
            [1, 0],
            [-1, 0],
          ]) {
            let nx = cx + dx,
              ny = cy + dy;
            if (map[ny][nx] !== 1 && !visited.has(`${nx},${ny}`)) {
              visited.add(`${nx},${ny}`);
              queue.push([nx, ny, [...path, { x: nx, y: ny }]]);
            }
          }
        }
        return hunter;
      }

      function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for (let y = 0; y < GRID_H; y++) {
          for (let x = 0; x < GRID_W; x++) {
            if (map[y][x] === 1) {
              ctx.fillStyle = "#1919a6";
              ctx.fillRect(
                x * TILE_SIZE,
                y * TILE_SIZE,
                TILE_SIZE - 1,
                TILE_SIZE - 1,
              );
            } else if (map[y][x] === 2) {
              ctx.fillStyle = "#ffb8ae";
              ctx.beginPath();
              ctx.arc(
                x * TILE_SIZE + 20,
                y * TILE_SIZE + 20,
                4,
                0,
                Math.PI * 2,
              );
              ctx.fill();
            } else if (map[y][x] === 3) {
              ctx.fillStyle = "#00ff00";
              ctx.beginPath();
              ctx.arc(
                x * TILE_SIZE + 20,
                y * TILE_SIZE + 20,
                8,
                0,
                Math.PI * 2,
              );
              ctx.fill();
            }
          }
        }
        // Draw Player
        ctx.fillStyle = "yellow";
        ctx.fillRect(p1.x * TILE_SIZE + 8, p1.y * TILE_SIZE + 8, 24, 24);
        // Draw Hunter (Changes color if PowerUp active)
        ctx.fillStyle = powerUpActive ? "#0000ff" : "#ff0000";
        ctx.fillRect(
          hunter.x * TILE_SIZE + 8,
          hunter.y * TILE_SIZE + 8,
          24,
          24,
        );
      }

      window.addEventListener("keydown", (e) => {
        if (isGameOver) return;
        let n1x = p1.x,
          n1y = p1.y;
        let n2x = hunter.x,
          n2y = hunter.y;

        // Player 1
        if (e.key === "ArrowUp") n1y--;
        else if (e.key === "ArrowDown") n1y++;
        else if (e.key === "ArrowLeft") n1x--;
        else if (e.key === "ArrowRight") n1x++;

        // Player 2 (If Versus)
        if (gameMode === "versus") {
          if (e.key.toLowerCase() === "w") n2y--;
          else if (e.key.toLowerCase() === "s") n2y++;
          else if (e.key.toLowerCase() === "a") n2x--;
          else if (e.key.toLowerCase() === "d") n2x++;
        }

        // Execute P1 Move
        if (map[n1y][n1x] !== 1) {
          p1.x = n1x;
          p1.y = n1y;
          if (map[p1.y][p1.x] === 2) {
            map[p1.y][p1.x] = 0;
            score += 10;
            scoreEl.innerText = score;
          }
          if (map[p1.y][p1.x] === 3) {
            map[p1.y][p1.x] = 0;
            activatePower();
          }
        }

        // Execute Hunter Move (AI or P2)
        if (gameMode === "solo" && !powerUpActive) {
          let next = getNextAIMove();
          hunter.x = next.x;
          hunter.y = next.y;
        } else if (gameMode === "versus" && map[n2y][n2x] !== 1) {
          hunter.x = n2x;
          hunter.y = n2y;
        }

        // Check Collision
        if (p1.x === hunter.x && p1.y === hunter.y) {
          if (powerUpActive) {
            hunter.x = 13;
            hunter.y = 13; // Respawn Hunter
            score += 100;
            scoreEl.innerText = score;
          } else {
            alert("GAME OVER! Score: " + score);
            location.reload();
          }
        }
        draw();
      });

      function activatePower() {
        powerUpActive = true;
        powerEl.innerText = "âš¡ POWER MODE ACTIVE";
        setTimeout(() => {
          powerUpActive = false;
          powerEl.innerText = "";
          draw();
        }, 5000);
      }

      draw();
    </script>
  </body>
</html>

